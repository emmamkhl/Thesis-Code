{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 #!/usr/bin/env python3\
# File: week5_gc_analysis.py\
\
import os\
from Bio import SeqIO\
import csv\
\
print("WEEK 5 gc content analysis\\n\'94)\
\
#####define genome paths\
genomes = \{\
    "hydra_vulgaris": "genomes/cnidaria/hydra_vulgaris.fna",\
    "clytia_hemisphaerica": "genomes/cnidaria/clytia_hemisphaerica.fna",\
    "nematostella_vectensis": "genomes/cnidaria/nematostella_vectensis.fna",\
    "daphnia_pulex": "genomes/crustacea/daphnia_pulex.fna",\
    "hyalella_azteca": "genomes/crustacea/hyalella_azteca.fna",\
    "lepeophtheirus_salmonis": "genomes/crustacea/lepeophtheirus_salmonis.fna",\
    "biomphalaria_glabrata": "genomes/mollusca/biomphalaria_glabrata.fna",\
    "crassostrea_ariakensis": "genomes/mollusca/crassostrea_ariakensis.fna",\
    "crassostrea_gigas": "genomes/mollusca/crassostrea_gigas.fna"\
\}\
\
def get_phylum(species):\
    if any(x in species for x in ["hydra", "clytia", "nematostella"]):\
        return "cnidaria"\
    elif any(x in species for x in ["daphnia", "hyalella", "lepeophtheirus"]):\
        return "crustacea"\
    else:\
        return "mollusca"\
\
def calculate_gc_content(fasta_file):\
    total_a = total_c = total_g = total_t = total_n = 0\
    \
    try:\
        for record in SeqIO.parse(fasta_file, "fasta"):\
            seq = str(record.seq).upper()\
            total_a += seq.count('A')\
            total_c += seq.count('C')\
            total_g += seq.count('G')\
            total_t += seq.count('T')\
            total_n += seq.count('N')\
    except Exception as e:\
        print(f"error reading \{fasta_file\}: \{e\}")\
        return None\
    \
    total_bases = total_a + total_c + total_g + total_t + total_n\
    \
    if total_bases == 0:\
        return None\
    \
    gc_percent = (total_g + total_c) / total_bases * 100\
    at_percent = (total_a + total_t) / total_bases * 100\
    n_percent = total_n / total_bases * 100\
    \
    return \{\
        'genome_size': total_bases,\
        'gc_content': round(gc_percent, 2),\
        'at_content': round(at_percent, 2),\
        'n_content': round(n_percent, 2)\
    \}\
\
#####create output file\
with open('gc_content_results.csv', 'w', newline='') as csvfile:\
    fieldnames = ['species', 'phylum', 'genome_size_bp', 'gc_content_percent', 'at_content_percent', 'n_content_percent']\
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)\
    writer.writeheader()\
    \
    for species, genome_file in genomes.items():\
        if os.path.exists(genome_file):\
            print(f"analyzing \{species\}...")\
            phylum = get_phylum(species)\
            \
            result = calculate_gc_content(genome_file)\
            if result:\
                writer.writerow(\{\
                    'species': species,\
                    'phylum': phylum,\
                    'genome_size_bp': result['genome_size'],\
                    'gc_content_percent': result['gc_content'],\
                    'at_content_percent': result['at_content'],\
                    'n_content_percent': result['n_content']\
                \})\
            else:\
                print(f"failed to analyze \{species\}")\
        else:\
            print(f"warning: \{genome_file\} not found")\
\
print("gc content analysis complete! results in gc_content_results.csv")\
\
\
\
####cross-taxa consistency assessment\
\
#!/usr/bin/env Rscript\
# File: week5_algorithm_comparison.R\
\
library(ggplot2)\
library(dplyr)\
library(readr)\
\
cat("week 5 comparative algorithm evaluation\\n\'94)\
\
##### read gc content data\
gc_data <- read_csv("gc_content_results.csv")\
cat("gc content data loaded\\n")\
print(gc_data)\
\
##### read repeat data from week 4\
if (file.exists("tables/species_summary_stats.csv")) \{\
    repeat_data <- read_csv("tables/species_summary_stats.csv")\
\} else \{\
    # create mock data if week 4 not run\
    repeat_data <- data.frame(\
        species = c("hydra_vulgaris", "clytia_hemisphaerica", "nematostella_vectensis",\
                   "daphnia_pulex", "hyalella_azteca", "lepeophtheirus_salmonis",\
                   "biomphalaria_glabrata", "crassostrea_ariakensis", "crassostrea_gigas"),\
        phylum = c("cnidaria", "cnidaria", "cnidaria", "crustacea", "crustacea", "crustacea",\
                  "mollusca", "mollusca", "mollusca"),\
        total_repeats = c(455731, 1192051, 525833, 134595, 465000, 380000, 2466327, 1345848, 1091550),\
        mean_divergence = c(11.99, 12.02, 12.65, 13.17, 13.5, 12.8, 14.2, 12.5, 13.33),\
        unknown_percent = c(76.7, 80.9, 66.0, 40.0, 72.5, 68.0, 54.8, 73.4, 69.8)\
    )\
\}\
\
##### merge datasets\
combined_data <- merge(gc_data, repeat_data, by = c("species", "phylum"))\
\
cat("\\n=== 1. GC CONTENT ANALYSIS ===\\n")\
gc_summary <- combined_data %>%\
    group_by(phylum) %>%\
    summarise(\
        n_species = n(),\
        mean_gc = round(mean(gc_content_percent), 2),\
        sd_gc = round(sd(gc_content_percent), 2),\
        min_gc = round(min(gc_content_percent), 2),\
        max_gc = round(max(gc_content_percent), 2),\
        .groups = 'drop'\
    )\
print(gc_summary)\
\
##### plot 1 gc content by phylum\
p1 <- ggplot(combined_data, aes(x = reorder(species, gc_content_percent), \
                                y = gc_content_percent, fill = phylum)) +\
    geom_bar(stat = "identity") +\
    coord_flip() +\
    labs(title = "gc content by species and phylum",\
         x = "species", y = "gc content (%)", fill = "phylum") +\
    theme_minimal() +\
    theme(plot.title = element_text(hjust = 0.5),\
          axis.text.y = element_text(size = 10))\
\
ggsave("plots/week5_gc_content_by_species.png", p1, width = 12, height = 8, dpi = 300)\
\
cat("\\n=== 2. correlation analysis ===\\n")\
gc_repeat_cor <- cor(combined_data$gc_content_percent, combined_data$total_repeats)\
gc_divergence_cor <- cor(combined_data$gc_content_percent, combined_data$mean_divergence)\
gc_unknown_cor <- cor(combined_data$gc_content_percent, combined_data$unknown_percent)\
\
cat("gc vs total repeats correlation:", round(gc_repeat_cor, 3), "\\n")\
cat("gc vs mean divergence correlation:", round(gc_divergence_cor, 3), "\\n")\
cat("gc vs unknown percent correlation:", round(gc_unknown_cor, 3), "\\n")\
\
##### plot 2: gc vs repeat content\
p2 <- ggplot(combined_data, aes(x = gc_content_percent, y = total_repeats/1e6, color = phylum)) +\
    geom_point(size = 4) +\
    geom_smooth(method = "lm", se = FALSE, linetype = "dashed") +\
    geom_text(aes(label = gsub("_", " ", species)), vjust = -0.5, hjust = 0.5, size = 3) +\
    labs(title = "gc content vs repeat content",\
         x = "gc content (%)", y = "total repeats (millions)", color = "phylum") +\
    theme_minimal() +\
    theme(plot.title = element_text(hjust = 0.5))\
\
ggsave("plots/week5_gc_vs_repeats.png", p2, width = 12, height = 8, dpi = 300)\
\
cat("\\n=== 3. algorithm comparison framework ===\\n")\
algorithm_comparison <- data.frame(\
    algorithm = c("repeatmasker", "edta", "red"),\
    method = c("similarity-based", "structural-based", "k-mer frequency"),\
    approach = c("database matching", "ab initio + ml", "statistical modeling"),\
    best_for_cnidaria = c("poor (unknown)", "good (ab initio)", "good (frequency)"),\
    best_for_mollusca = c("good (known tes)", "excellent (complex)", "moderate"),\
    best_for_crustacea = c("good (simple)", "moderate", "good (patterns)")\
)\
print(algorithm_comparison)\
\
cat("\\n=== 4. phylum specific drivers ===\\n")\
phylum_drivers <- combined_data %>%\
    group_by(phylum) %>%\
    summarise(\
        mean_genome_size = round(mean(genome_size_bp)/1e6, 1),\
        mean_gc = round(mean(gc_content_percent), 2),\
        mean_repeats = round(mean(total_repeats)/1e6, 2),\
        mean_unknown = round(mean(unknown_percent), 1),\
        mean_divergence = round(mean(mean_divergence), 2),\
        repeat_density = round(mean(total_repeats/genome_size_bp * 1000), 1),\
        .groups = 'drop'\
    )\
print(phylum_drivers)\
\
##### save results\
write_csv(combined_data, "week5_combined_analysis.csv")\
write_csv(gc_summary, "week5_gc_summary.csv")\
write_csv(phylum_drivers, "week5_phylum_drivers.csv")\
write_csv(algorithm_comparison, "week5_algorithm_comparison.csv")\
\
cat("\\n=== week 5 complete ===\\n")\
cat("generated files:\\n")\
cat("- week5_gc_content_by_species.png\\n")\
cat("- week5_gc_vs_repeats.png\\n")\
cat("- week5_combined_analysis.csv\\n")\
cat("- week5_gc_summary.csv\\n")\
cat("- week5_phylum_drivers.csv\\n")\
cat("- week5_algorithm_comparison.csv\\n")}
